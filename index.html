<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liste Dynamique CSV</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; cursor: pointer; }
        th { background-color: #f4f4f4; }
        th.sorted-asc::after { content: " üîº"; }
        th.sorted-desc::after { content: " üîΩ"; }
        #message { font-weight: bold; margin-top: 20px; }
        #searchInput { margin-top: 10px; padding: 5px; width: 100%; font-size: 16px; }
    </style>
</head>
<body>

    <table id="myTable">
        <tr>
            <th>Nom</th>
            <th>√Çge</th>
        </tr>
        <!-- Les donn√©es seront ajout√©es ici -->
    </table>
    
    <button onclick="readData()">Charger les donn√©es</button>

    <script>
        // Charger l'API Google Sheets
        function loadClient() {
            gapi.client.setApiKey('AIzaSyBgtbd5GfM7WCPHx9edD2y1k0BGjJuplxw');  // Remplace 'TON_CLE_API' par ta cl√© API
            return gapi.client.load('https://sheets.googleapis.com/$discovery/rest?version=v4')
                .then(function() {
                    console.log("API client loaded for Google Sheets");
                }, function(error) {
                    console.error("Error loading API client", error);
                });
        }
    
        // Fonction pour lire les donn√©es depuis Google Sheets
        function readData() {
            var spreadsheetId = '1NIf0WW4AQjA-7JXAQjjWo6RAxU0woHc0ECgl3ePAXaw'; // Remplace avec l'ID de ton Google Sheets
            var range = 'Sheet1!A1:B10';  // La plage de cellules √† lire (par exemple A1:B10)
            
            var request = gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: spreadsheetId,
                range: range
            });
            
            request.then(function(response) {
                var data = response.result.values;
                console.log(data);  // Affiche les donn√©es r√©cup√©r√©es
                // Ajouter les donn√©es dans le tableau HTML
                var table = document.getElementById('myTable');
                for (var i = 0; i < data.length; i++) {
                    var row = table.insertRow(i + 1); // Ajouter une nouvelle ligne (√† partir de la 2e ligne)
                    for (var j = 0; j < data[i].length; j++) {
                        var cell = row.insertCell(j);
                        cell.textContent = data[i][j]; // Ins√©rer les donn√©es dans les cellules
                    }
                }
            }, function(error) {
                console.error("Erreur lors de la lecture des donn√©es", error);
            });
        }
    
        // Fonction pour mettre √† jour les donn√©es dans Google Sheets
        function updateData() {
            var spreadsheetId = '1NIf0WW4AQjA-7JXAQjjWo6RAxU0woHc0ECgl3ePAXaw'; // ID de ton Google Sheets
            var range = 'Sheet1!A2';  // Plage de la cellule √† mettre √† jour
            var values = [
                ["Alice", 28]  // Les nouvelles donn√©es √† ins√©rer
            ];
            
            var body = {
                values: values
            };
            
            var request = gapi.client.sheets.spreadsheets.values.update({
                spreadsheetId: spreadsheetId,
                range: range,
                valueInputOption: 'RAW',
                resource: body
            });
            
            request.then(function(response) {
                console.log("Donn√©es mises √† jour avec succ√®s", response);
            }, function(error) {
                console.error("Erreur lors de la mise √† jour des donn√©es", error);
            });
        }

        // Charger l'API et appeler la fonction loadClient
        gapi.load('client', loadClient);
    </script>

</body>
</html>
